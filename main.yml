---
# Setup Nginx
- hosts: all
  gather_facts: no
  pre_tasks:
    - raw: zypper install python3-virtualenv -n
  tasks:

  - name: Install a list of packages
    zypper:
      name: "{{ packages }}"
    vars:
      packages:
      - nginx
      - curl
    become: yes

  - name: enable ufw ssh
    raw: sudo ufw disable
    become: yes

  - name: Make sure a service nginx is running
    systemd:
      name: nginx
      state: started
    become: yes

  - name: make www
    command: sudo ls -la /var/www
    register: result
    ignore_errors: True
    become: yes

  - command: sudo mkdir -p /var/www
    when: result is failed
    become: yes

  - name: make demoapp
    command: sudo ls -la /var/www/demoapp
    register: result
    ignore_errors: True
    become: yes

  - command: sudo mkdir -p /var/www/demoapp
    when: result is failed
    become: yes
  

